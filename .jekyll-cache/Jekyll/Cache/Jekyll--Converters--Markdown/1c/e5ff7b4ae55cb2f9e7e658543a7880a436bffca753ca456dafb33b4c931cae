I"¡§<h1 class="no_toc" id="exceptions">Exceptions</h1>

<h2 class="no_toc text-delta" id="table-of-contents">Table of Contents</h2>

<ol id="markdown-toc">
  <li><a href="#understanding-exceptions" id="markdown-toc-understanding-exceptions">Understanding Exceptions</a>    <ol>
      <li><a href="#what-is-an-exception" id="markdown-toc-what-is-an-exception">What is an Exception?</a></li>
      <li><a href="#flow-of-code" id="markdown-toc-flow-of-code">Flow of Code</a></li>
      <li><a href="#execution-call-stack" id="markdown-toc-execution-call-stack">Execution Call Stack</a></li>
    </ol>
  </li>
  <li><a href="#unhandled-exceptions" id="markdown-toc-unhandled-exceptions">Unhandled Exceptions</a>    <ol>
      <li><a href="#unhandled-exceptions-in-visual-studio" id="markdown-toc-unhandled-exceptions-in-visual-studio">Unhandled Exceptions In Visual Studio</a></li>
    </ol>
  </li>
  <li><a href="#handling-exceptions" id="markdown-toc-handling-exceptions">Handling Exceptions</a></li>
  <li><a href="#referencing-handled-exceptions" id="markdown-toc-referencing-handled-exceptions">Referencing Handled Exceptions</a></li>
  <li><a href="#anticipating-exceptions" id="markdown-toc-anticipating-exceptions">Anticipating Exceptions</a></li>
  <li><a href="#common-net-exception-types" id="markdown-toc-common-net-exception-types">Common .NET Exception Types</a></li>
  <li><a href="#generating-exceptions" id="markdown-toc-generating-exceptions">Generating Exceptions</a></li>
  <li><a href="#documentation" id="markdown-toc-documentation">Documentation</a></li>
  <li><a href="#testing-exceptions" id="markdown-toc-testing-exceptions">Testing Exceptions</a></li>
  <li><a href="#further-reading" id="markdown-toc-further-reading">Further Reading</a></li>
</ol>

<p>It is inevitable that at some point in the process of developing an application an error will occur. No matter how good of a programmer you are, errors will happen.</p>

<p><strong>Exceptions</strong> are special types of errors, generated by the operating system or by using someone else‚Äôs code. Newer programmers view exceptions as a negative part of programming, because when an exception is not handled your program will abnormally end.  Exceptions are similar to compiler errors in that they aid a programmer into developing better code. To debug and fix exceptions, you must understand:</p>

<ul>
  <li>what exceptions are.</li>
  <li>how they affect the flow of code.</li>
  <li>how to gain information from the exception.</li>
  <li>how to handle an exception.</li>
  <li>the requirements for how the exception should be handled.</li>
</ul>

<h2 id="understanding-exceptions">Understanding Exceptions</h2>

<p>Although exceptions are a tool for programmers to make their code better, they are not desired. Having your program end abnormally will never be a requirement of any application you develop.</p>

<p>Exceptions are errors that only occur during the execution of a program. As previously mentioned, if an exception is not handled, the execution of the program will abnormally end.</p>

<p>Exceptions are generated when an illegal operation takes place. An example of this would be to perform division by zero.  Exceptions also occur when invoking methods. Usually methods written by another programmer. An example of this would be trying to parse non-numeric data to a numeric type.</p>

<h3 id="what-is-an-exception">What is an Exception?</h3>

<p>An exception is an object. This means that an exception is an instance of a class. All exceptions derive from the base class <code class="language-plaintext highlighter-rouge">System.Exception</code>. There are many exception types that are defined in the framework of most OOP languages. All these exceptions types will derive directly or indirectly from the <code class="language-plaintext highlighter-rouge">Exception</code> class.</p>

<h3 id="flow-of-code">Flow of Code</h3>

<p>When an exception happens, two things take place:</p>

<ol>
  <li>An instance of an exception is created.</li>
  <li>The exception is thrown down the <a href="#method-call-stack">Execution Call Stack</a>.</li>
</ol>

<p>When an exception is thrown down the method call stack, the normal flow of the code does not happen. This means that when a exception occurs, no code will execute. As the exception traverses down the call stack, the run-time is looking for the exception to be handled.  If the exception is handled at some point in the execution call stack, they flow of code is regained. If run-time makes it to the bottom of the execution call stack and does not find code to handle the exception, the program will terminate.</p>

<h3 id="execution-call-stack">Execution Call Stack</h3>

<p>The <strong>Execution Call Stack</strong>, or just <em>call stack</em>, keeps track of each active method and where a method should return to when it finishes executing. When a method is invoked (called), it is added (pushed on) to the call stack. The first method on the call stack is always the <em>Main</em> method.  When a method completes, the method is removed from (popped off) the call stack, and execution continues where the previous method left off. The program ends when the last method (Main) is removed from the call stack.</p>

<p>This sample program has several methods. Each method has at least two statements. The first statement prints a message to indicate the method has been added to the stack. The last statement prints a message to indicate the method has been removed from the stack.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">internal</span> <span class="k">class</span> <span class="nc">Program</span> 
<span class="p">{</span>
    <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="n">String</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Main - Added to the call stack."</span><span class="p">);</span>

        <span class="nf">MethodB</span><span class="p">();</span>

        <span class="nf">MethodC</span><span class="p">();</span>

        <span class="nf">MethodD</span><span class="p">();</span>

        <span class="nf">MethodE</span><span class="p">();</span>

        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Main - Removed from the call stack."</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">MethodA</span><span class="p">(</span><span class="n">String</span> <span class="n">message</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"MethodA - Added to the call stack."</span><span class="p">);</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"MethodA - Removed from the call stack."</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">MethodB</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"MethodB - Added to the call stack."</span><span class="p">);</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"MethodB - Removed from the call stack."</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">MethodC</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"MethodC - Added to the call stack."</span><span class="p">);</span>
        
        <span class="nf">MethodB</span><span class="p">();</span>
        
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"MethodC - Removed from the call stack."</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="n">String</span> <span class="nf">MethodD</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"MethodD - Added to the call stack."</span><span class="p">);</span>
        
        <span class="nf">MethodC</span><span class="p">();</span>
        
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"MethodD - Removed from the call stack."</span><span class="p">);</span>
        <span class="k">return</span> <span class="s">"Hello World"</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">MethodE</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"MethodE - Added to the call stack."</span><span class="p">);</span>
        
        <span class="nf">MethodA</span><span class="p">(</span><span class="nf">MethodD</span><span class="p">());</span>
        
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"MethodE - Removed from the call stack."</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>This simple application demonstrates the call stack. You can see that the main method is the first method in the call stack and is not removed until the very end.</p>

<p>Each time a method is invoked, it becomes active and is added to the call stack and is not removed until all other active methods added after it have been completed and removed.</p>

<p>Output:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Main - Added to the call stack.
MethodB - Added to the call stack.
MethodB - Removed from the call stack.
MethodC - Added to the call stack.
MethodB - Added to the call stack.
MethodB - Removed from the call stack.
MethodC - Removed from the call stack.
MethodD - Added to the call stack.
MethodC - Added to the call stack.
MethodB - Added to the call stack.
MethodB - Removed from the call stack.
MethodC - Removed from the call stack.
MethodD - Removed from the call stack.
MethodE - Added to the call stack.
MethodD - Added to the call stack.
MethodC - Added to the call stack.
MethodB - Added to the call stack.
MethodB - Removed from the call stack.
MethodC - Removed from the call stack.
MethodD - Removed from the call stack.
MethodA - Added to the call stack.
MethodA - Removed from the call stack.
MethodE - Removed from the call stack.
Main - Removed from the call stack.
</code></pre></div></div>

<h2 id="unhandled-exceptions">Unhandled Exceptions</h2>

<p>When an exception occurs, it will be generated (thrown) in the method currently at the top of the stack. Execution of the code will stop. The run-time will evaluate each method in the call stack to determine if the exception is handled. If it is handled, execution of code will continue at that point in the call stack. If the exception is not handled at any point in the call stack, the program will terminate.</p>

<p><img src="../images/exceptions/exception-call-stack.png" alt=".NET Call Stack" class="large my-md-3 mx-auto" /></p>

<p>If the implementation of <code class="language-plaintext highlighter-rouge">MethodB()</code> is updated:</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">MethodB</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"MethodB - Added to the call stack."</span><span class="p">);</span>

    <span class="c1">// This line will generate an exception</span>
    <span class="kt">double</span><span class="p">.</span><span class="nf">Parse</span><span class="p">(</span><span class="s">"Hello"</span><span class="p">);</span>

    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"MethodB - Removed from the call stack."</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>Output:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Main - Added to the call stack.
MethodB - Added to the call stack.

Unhandled Exception: System.FormatException: Input string was not in a correct format.
   at System.Number.ParseDouble(String value, NumberStyles options, NumberFormatInfo numfmt)
   at System.Double.Parse(String s)
   at ADEV.Module2.App.Program.MethodB() in C:\source\ADEV.Module2.App\Program.cs:line 41
   at ADEV.Module2.App.Program.Main(String[] args) in C:\source\ADEV.Module2.App\Program.cs:line 15
</code></pre></div></div>

<p>You can see from the output of this program, that the program does not end properly. Had it ended properly, you would see the <code class="language-plaintext highlighter-rouge">Main()</code> method removed from the call stack. You can also see that <code class="language-plaintext highlighter-rouge">MethodB()</code> also did not complete properly, as it too was not removed from the call stack.</p>

<p>Exceptions interrupt the normal flow a program.</p>

<p>The program ends with information printed about the exception that was generated. This information can be intimidating to read at first. The more you mistakes you make, the more times you‚Äôll read it. The more you read it, the better you‚Äôll get at understanding it.</p>

<p>You can see that the type of exception was <code class="language-plaintext highlighter-rouge">FormatException</code>. The data that caused the exception was the String <code class="language-plaintext highlighter-rouge">"Hello"</code>. The text after this line displays the <strong>stack trace</strong>. The stack trace shows us the methods that were called, in the order they were added to the call stack, from main to the method where the exception was generated.</p>

<p>As your programs become more complicated, the stack trace is essential information for fixing defects.</p>

<h3 id="unhandled-exceptions-in-visual-studio">Unhandled Exceptions In Visual Studio</h3>

<p>When executing your program in Visual Studio, unhandled exceptions will stop the execution of the program and the statement that caused the exception is highlighted.</p>

<p><img src="../images/exceptions/vs-unhandled-exception.png" alt="Unhandled Exceptions In Visual Studio" class="large" /></p>

<p>The callout box seen in the image above, shows the type of exception, exception message, and the stack trace. Read all of this before stopping the execution of the program.</p>

<h2 id="handling-exceptions">Handling Exceptions</h2>

<p>An exception is handled using a <code class="language-plaintext highlighter-rouge">try...catch</code> structure. Generally speaking, you would put the statement that would potentially generate the exception within a <code class="language-plaintext highlighter-rouge">try</code> block. If the exception is generated, the exception is caught by the <code class="language-plaintext highlighter-rouge">catch</code> statement and execution of the code continues from the catch block.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">MethodB</span><span class="p">()</span>
<span class="p">{</span>
    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"MethodB - Added to the call stack."</span><span class="p">);</span>

    <span class="k">try</span>
    <span class="p">{</span>
        <span class="c1">// This line will generate an exception</span>
        <span class="kt">double</span><span class="p">.</span><span class="nf">Parse</span><span class="p">(</span><span class="s">"Hello"</span><span class="p">);</span>
    <span class="p">}</span>
    <span class="k">catch</span> <span class="p">(</span><span class="n">FormatException</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Failed to parse the data to a double."</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"MethodB - Removed from the call stack."</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p class="alert alert-best-practices">In almost all cases, it is necessary to include the exception type in the <code class="language-plaintext highlighter-rouge">catch</code> statement. Although it can be omitted, it would catch all exceptions. This may sound great in theory, but would hide potential problems in your code.</p>

<p>Output:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Main - Added to the call stack.
MethodB - Added to the call stack.
Failed to parse the data to a double.
MethodB - Removed from the call stack.
MethodC - Added to the call stack.
MethodB - Added to the call stack.
Failed to parse the data to a double.
MethodB - Removed from the call stack.
MethodC - Removed from the call stack.
MethodD - Added to the call stack.
MethodC - Added to the call stack.
MethodB - Added to the call stack.
Failed to parse the data to a double.
MethodB - Removed from the call stack.
MethodC - Removed from the call stack.
MethodD - Removed from the call stack.
MethodE - Added to the call stack.
MethodD - Added to the call stack.
MethodC - Added to the call stack.
MethodB - Added to the call stack.
Failed to parse the data to a double.
MethodB - Removed from the call stack.
MethodC - Removed from the call stack.
MethodD - Removed from the call stack.
MethodA - Added to the call stack.
MethodA - Removed from the call stack.
MethodE - Removed from the call stack.
Main - Removed from the call stack.
</code></pre></div></div>

<p>It is important to understand the requirements of the code you are writing, as this determines where the <code class="language-plaintext highlighter-rouge">try...catch</code> block is coded. The <code class="language-plaintext highlighter-rouge">try...catch</code> block is always coded where the exception is to be handled.</p>

<p>In this updated version of the program, the exception is being handled in the <code class="language-plaintext highlighter-rouge">Main()</code> method, which is lower in the call stack.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">internal</span> <span class="k">class</span> <span class="nc">Program</span> 
<span class="p">{</span>
    <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="n">String</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Main - Added to the call stack."</span><span class="p">);</span>

        <span class="k">try</span>
        <span class="p">{</span>
            <span class="nf">MethodB</span><span class="p">();</span>

            <span class="nf">MethodC</span><span class="p">();</span>

            <span class="nf">MethodD</span><span class="p">();</span>

            <span class="nf">MethodE</span><span class="p">();</span>
        <span class="p">}</span>
        <span class="k">catch</span> <span class="p">(</span><span class="n">FormatException</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Failed to parse the data to a double."</span><span class="p">);</span>
        <span class="p">}</span>  

        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Main - Removed from the call stack."</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">MethodA</span><span class="p">(</span><span class="n">String</span> <span class="n">message</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"MethodA - Added to the call stack."</span><span class="p">);</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"MethodA - Removed from the call stack."</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">MethodB</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"MethodB - Added to the call stack."</span><span class="p">);</span>

        <span class="c1">// This line will generate an exception</span>
        <span class="kt">double</span><span class="p">.</span><span class="nf">Parse</span><span class="p">(</span><span class="s">"Hello"</span><span class="p">);</span>

        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"MethodB - Removed from the call stack."</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">MethodC</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"MethodC - Added to the call stack."</span><span class="p">);</span>
        
        <span class="nf">MethodB</span><span class="p">();</span>
        
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"MethodC - Removed from the call stack."</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="n">String</span> <span class="nf">MethodD</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"MethodD - Added to the call stack."</span><span class="p">);</span>
        
        <span class="nf">MethodC</span><span class="p">();</span>
        
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"MethodD - Removed from the call stack."</span><span class="p">);</span>
        <span class="k">return</span> <span class="s">"Hello World"</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">MethodE</span><span class="p">()</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"MethodE - Added to the call stack."</span><span class="p">);</span>
        
        <span class="nf">MethodA</span><span class="p">(</span><span class="nf">MethodD</span><span class="p">());</span>
        
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"MethodE - Removed from the call stack."</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>You can see from the output below that the result is very different from when the exception was handled in <code class="language-plaintext highlighter-rouge">MethodB()</code>.</p>

<p>Output:</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Main - Added to the call stack.
MethodB - Added to the call stack.
Failed to parse the data to a double.
Main - Removed from the call stack.
</code></pre></div></div>

<p>If the code you are trying to execute has the potential to generate multiple types of exceptions, multiple <code class="language-plaintext highlighter-rouge">catch</code> statements can be defined beneath the <code class="language-plaintext highlighter-rouge">try</code> block.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">try</span>
<span class="p">{</span>
    
<span class="p">}</span>
<span class="k">catch</span> <span class="p">(</span><span class="n">FormatException</span><span class="p">)</span>
<span class="p">{</span>

<span class="p">}</span>
<span class="k">catch</span> <span class="p">(</span><span class="n">ArgumentOutOfRangeException</span><span class="p">)</span>
<span class="p">{</span>

<span class="p">}</span>
</code></pre></div></div>

<h2 id="referencing-handled-exceptions">Referencing Handled Exceptions</h2>

<p>If you need to obtain information about a handled exception, you can declare a variable to reference the exception.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">try</span>
<span class="p">{</span>
    
<span class="p">}</span>
<span class="k">catch</span> <span class="p">(</span><span class="n">FormatException</span> <span class="n">exception</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Log</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="n">excpetion</span><span class="p">.</span><span class="n">StackTrace</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p class="alert alert-note">The scope of the variable is limited to the <code class="language-plaintext highlighter-rouge">catch</code> block.</p>

<h2 id="anticipating-exceptions">Anticipating Exceptions</h2>

<p><a href="images/exceptions/parse-documentation.png" target="_blank"><img src="images/exceptions/parse-documentation.png" alt="Parse Documentation" class="medium inline" /></a></p>

<p>By reading the documentation for a method you are calling, you can determine if there is a potential for an exception to occur. If a method generates an exception, a section with the heading ‚ÄúExceptions‚Äù will exists. The documentation will list the type of exceptions that are thrown and what circumstances need to occur for the exception to be thrown.</p>

<p>System exceptions are also documented, but can be found in explanations about how the language works. For example, the <code class="language-plaintext highlighter-rouge">DivideByZeroException</code> is generated when using the division (<code class="language-plaintext highlighter-rouge">/</code>) operator and the second operand is a zero. This exception doesn‚Äôt happen when you invoke a method.</p>

<h2 id="common-net-exception-types">Common .NET Exception Types</h2>

<p>Exceptions are types that derive from the <code class="language-plaintext highlighter-rouge">System.Exception</code> class. The .NET Framework includes many exceptions types.</p>

<p>Here are some common exceptions:</p>

<ul>
  <li><strong>ArgumentException</strong> - Thrown when any argument is invalid.</li>
  <li><strong>ArgumentNullException</strong> - Thrown when an argument is null.</li>
  <li><strong>ArgumentOutOfRangeException</strong> - Thrown when an argument value is out of the intended range.</li>
  <li><strong>FormatException</strong> - Thrown when an argument does not meet the format specifications intended by the method.</li>
  <li><strong>IndexOutOfRangeException</strong> - Thrown when you attempt to index an array using an index that is less than zero or greater than the length - 1.</li>
  <li><strong>InvalidCastException</strong> - Thrown when an explicit conversion from a base type or interface to a derived type fails.</li>
  <li><strong>NullReferenceException</strong> - Thrown when a null reference is used.</li>
  <li><strong>SystemException</strong> - Generated by the CLR.</li>
</ul>

<p>Notable exception members:</p>

<ul>
  <li><strong>Message</strong> - Gets a message that describes the exception.</li>
  <li><strong>StackTrace</strong> - Gets a string representation of the frames in the call stack.</li>
</ul>

<h2 id="generating-exceptions">Generating Exceptions</h2>

<p>When developing code, mostly when developing data types, you will at some point need to generate an exception. Generating exceptions in your code helps another develop using your code by letting them know that they‚Äôve done something incorrectly.</p>

<p>To demonstration this, analyze the following code:</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">class</span> <span class="nc">Person</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="kt">decimal</span> <span class="n">amountOfMoney</span><span class="p">;</span>

    <span class="k">public</span> <span class="kt">decimal</span> <span class="nf">AddMoney</span><span class="p">(</span><span class="kt">decimal</span> <span class="n">amount</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">this</span><span class="p">.</span><span class="n">amountOfMoney</span> <span class="p">+=</span> <span class="n">amount</span><span class="p">;</span>

        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="n">amountOfMoney</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>If someone using <code class="language-plaintext highlighter-rouge">AddMoney(decimal)</code> method passes a negative numeric value as an argument, the method will not calculate the <code class="language-plaintext highlighter-rouge">amountOfMoney</code> as intended. It should be noted that there is no way for the developer coding the <code class="language-plaintext highlighter-rouge">AddMoney(decimal)</code> to prevent a negative numeric value as an argument.</p>

<p>You are probably already thinking that this can be avoided by using a selection, and you wouldn‚Äôt be wrong.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">class</span> <span class="nc">Person</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="kt">decimal</span> <span class="n">amountOfMoney</span><span class="p">;</span>

    <span class="k">public</span> <span class="kt">decimal</span> <span class="nf">AddMoney</span><span class="p">(</span><span class="kt">decimal</span> <span class="n">amount</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">amount</span> <span class="p">&lt;</span> <span class="m">0</span><span class="p">)</span>
        <span class="p">{</span>

        <span class="p">}</span>

        <span class="k">this</span><span class="p">.</span><span class="n">amountOfMoney</span> <span class="p">+=</span> <span class="n">amount</span><span class="p">;</span>

        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="n">amountOfMoney</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>The question is, what do you do when you‚Äôve determined the <code class="language-plaintext highlighter-rouge">amount</code> is a negative value?</p>

<p>Newer programmers would usually want to print an error message, telling the user that something went wrong.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">if</span><span class="p">(</span><span class="n">amount</span> <span class="p">&lt;</span> <span class="m">0</span><span class="p">)</span>
<span class="p">{</span>
    <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Amount cannot be a negative value."</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>There is a few problems with this approach:</p>

<ul>
  <li>If the application is not a Console Application, this message would not be visible and would be overlooked.</li>
  <li>Seeing as though the message is being printed to the user, this message could be missed by the developer of the <code class="language-plaintext highlighter-rouge">Person</code> class.</li>
  <li>Because the code execution would continue after this selection, the statement <code class="language-plaintext highlighter-rouge">amount = 0;</code> would be needed to avoid a logic error.</li>
</ul>

<p>The correct approach would be to generate an exception. Since it is required that the <code class="language-plaintext highlighter-rouge">amount</code> parameter be a zero or positive numeric value, a <code class="language-plaintext highlighter-rouge">ArgumentOutOfRangeException</code> would be generated when the <code class="language-plaintext highlighter-rouge">amount</code> is negative.</p>

<p>Generating an exception takes two steps:</p>

<ol>
  <li>Generate an instance of an exception class.</li>
  <li><code class="language-plaintext highlighter-rouge">throw</code> the exception instance.</li>
</ol>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">public</span> <span class="k">class</span> <span class="nc">Person</span>
<span class="p">{</span>
    <span class="k">private</span> <span class="kt">decimal</span> <span class="n">amountOfMoney</span><span class="p">;</span>

    <span class="k">public</span> <span class="kt">decimal</span> <span class="nf">AddMoney</span><span class="p">(</span><span class="kt">decimal</span> <span class="n">amount</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="k">if</span><span class="p">(</span><span class="n">amount</span> <span class="p">&lt;</span> <span class="m">0</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">ArgumentOutOfRangeException</span> <span class="n">exception</span><span class="p">;</span>
            <span class="n">exception</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">ArgumentOutOfRangeException</span><span class="p">(</span><span class="s">"amount"</span><span class="p">,</span> <span class="s">"The argument cannot be less than zero."</span><span class="p">);</span>

            <span class="k">throw</span> <span class="n">exception</span><span class="p">;</span>
        <span class="p">}</span>

        <span class="k">this</span><span class="p">.</span><span class="n">amountOfMoney</span> <span class="p">+=</span> <span class="n">amount</span><span class="p">;</span>

        <span class="k">return</span> <span class="k">this</span><span class="p">.</span><span class="n">amountOfMoney</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<p>When the code execution performs the <code class="language-plaintext highlighter-rouge">throw</code> statement, the flow of code is interrupted and the run-time will traverse the call stack to determine if the exception is handled.</p>

<h2 id="documentation">Documentation</h2>

<p>When a method or property contains code that potentially throws an exception, information about the exception must be documented.</p>

<p>When XML documentation is generated, Visual Studio does not parse the implementation of the unit, only its declaration. Therefore, you must manually add the XML to the documentation for things like exceptions.</p>

<p>Exceptions are documented in an <code class="language-plaintext highlighter-rouge">&lt;exception&gt;...&lt;/exception&gt;</code> element.</p>

<p>The documentation will include only one exception element per exception type generated in the method or property.The exception element will include one attribute, called <code class="language-plaintext highlighter-rouge">cref</code>, that is equal to the fully qualified name of the exception data type.  The data within the element is the description of the situation(s) when that exception is thrown in the unit.  The text typically starts with ‚ÄúThrown when‚Äù.</p>

<p><a href="../appendixes/documentation-samples.html#exceptions">Check out documentation samples</a></p>

<h2 id="testing-exceptions">Testing Exceptions</h2>

<p>The sample code below demonstrates how you can test exceptions in a command-line program.</p>

<div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">class</span> <span class="nc">Program</span>
<span class="p">{</span>
    <span class="k">static</span> <span class="k">void</span> <span class="nf">Main</span><span class="p">(</span><span class="kt">string</span><span class="p">[]</span> <span class="n">args</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Testing method AddMoney(decimal)"</span><span class="p">);</span>

        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Test 1"</span><span class="p">);</span>
        <span class="nf">AddMoney_AmountBelowZero_ExceptionThrown</span><span class="p">();</span>

        <span class="n">Console</span><span class="p">.</span><span class="nf">Write</span><span class="p">(</span><span class="s">"Press any key to continue..."</span><span class="p">);</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">ReadKey</span><span class="p">();</span>
    <span class="p">}</span>

    <span class="k">private</span> <span class="k">static</span> <span class="k">void</span> <span class="nf">AddMoney_AmountBelowZero_ExceptionThrown</span><span class="p">()</span>
    <span class="p">{</span>            
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Expected parameter: amount"</span><span class="p">);</span>
        <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Expected message: The argument cannot be less than zero."</span><span class="p">);</span>

        <span class="k">try</span>
        <span class="p">{</span>
            <span class="n">Person</span> <span class="n">target</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Person</span><span class="p">();</span>
            <span class="n">target</span><span class="p">.</span><span class="nf">AddMoney</span><span class="p">(-</span><span class="m">1000</span><span class="p">);</span>
        <span class="p">}</span>
        <span class="k">catch</span> <span class="p">(</span><span class="n">ArgumentOutOfRangeException</span> <span class="n">exception</span><span class="p">)</span>
        <span class="p">{</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Actual parameter: {0}"</span><span class="p">,</span> <span class="n">exception</span><span class="p">.</span><span class="n">ParamName</span><span class="p">);</span>
            <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"Actual message: {0}"</span><span class="p">,</span> <span class="n">exception</span><span class="p">.</span><span class="n">Message</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="further-reading">Further Reading</h2>

<ul>
  <li><a href="https://docs.microsoft.com/en-us/dotnet/csharp/fundamentals/exceptions/" target="_blank">Exceptions and Exception Handling</a></li>
</ul>
:ET