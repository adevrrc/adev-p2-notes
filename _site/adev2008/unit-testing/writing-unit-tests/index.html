<!DOCTYPE html> <html lang="en-US"> <head> <meta charset="UTF-8"> <meta http-equiv="X-UA-Compatible" content="IE=Edge"> <title>Writing Unit Tests - ADEV Programming</title> <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon"> <link rel="stylesheet" href="/assets/css/just-the-docs-default.css"> <script type="text/javascript" src="/assets/js/vendor/lunr.min.js"></script> <script type="text/javascript" src="/assets/js/just-the-docs.js"></script> <meta name="viewport" content="width=device-width, initial-scale=1"> <!-- Begin Jekyll SEO tag v2.8.0 --> <title>Writing Unit Tests | ADEV Programming</title> <meta name="generator" content="Jekyll v4.2.2" /> <meta property="og:title" content="Writing Unit Tests" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="A manual for ADEV2008 Programming" /> <meta property="og:description" content="A manual for ADEV2008 Programming" /> <link rel="canonical" href="http://localhost:8888/adev2008/unit-testing/writing-unit-tests/" /> <meta property="og:url" content="http://localhost:8888/adev2008/unit-testing/writing-unit-tests/" /> <meta property="og:site_name" content="ADEV Programming" /> <meta property="og:type" content="website" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:title" content="Writing Unit Tests" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"WebPage","description":"A manual for ADEV2008 Programming","headline":"Writing Unit Tests","url":"http://localhost:8888/adev2008/unit-testing/writing-unit-tests/"}</script> <!-- End Jekyll SEO tag --> <!-- <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox/dist/css/glightbox.min.css" /> <script src="https://cdn.jsdelivr.net/gh/mcstudios/glightbox/dist/js/glightbox.min.js"></script> <link rel="stylesheet" href="/assets/css/captionjs.min.css" /> <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script> <script type="text/javascript" src="/assets/js/jquery.caption.min.js"></script> <script type="text/javascript" src="/assets/js/custom.js"></script> --> </head> <body> <svg xmlns="http://www.w3.org/2000/svg" style="display: none;"> <symbol id="svg-link" viewBox="0 0 24 24"> <title>Link</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-link"> <path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"></path><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"></path> </svg> </symbol> <symbol id="svg-search" viewBox="0 0 24 24"> <title>Search</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-search"> <circle cx="11" cy="11" r="8"></circle><line x1="21" y1="21" x2="16.65" y2="16.65"></line> </svg> </symbol> <symbol id="svg-menu" viewBox="0 0 24 24"> <title>Menu</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"> <line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line> </svg> </symbol> <symbol id="svg-arrow-right" viewBox="0 0 24 24"> <title>Expand</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-chevron-right"> <polyline points="9 18 15 12 9 6"></polyline> </svg> </symbol> <symbol id="svg-doc" viewBox="0 0 24 24"> <title>Document</title> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file"> <path d="M13 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V9z"></path><polyline points="13 2 13 9 20 9"></polyline> </svg> </symbol> </svg> <div class="side-bar"> <div class="site-header"> <a href="http://localhost:8888/" class="site-title lh-tight"> ADEV Programming </a> <a href="#" id="menu-button" class="site-button"> <svg viewBox="0 0 24 24" class="icon"><use xlink:href="#svg-menu"></use></svg> </a> </div> <nav role="navigation" aria-label="Main" id="site-nav" class="site-nav"> <ul class="nav-list"><li class="nav-list-item"><a href="http://localhost:8888/" class="nav-list-link">Home</a></li><li class="nav-list-item"><a href="http://localhost:8888/read-me/" class="nav-list-link">README</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:8888/adev2008/intro-to-dotnet-csharp-vs" class="nav-list-link">Intro to .NET, C# & VS</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:8888/adev2008/intro-to-dotnet-csharp-vs/introduction-to-dotnet/" class="nav-list-link">Introduction to .NET</a></li><li class="nav-list-item "><a href="http://localhost:8888/adev2008/intro-to-dotnet-csharp-vs/visual-studio-ide/" class="nav-list-link">The Visual Studio IDE</a></li><li class="nav-list-item "><a href="http://localhost:8888/adev2008/intro-to-dotnet-csharp-vs/console-application-project/" class="nav-list-link">Console Application Project</a></li><li class="nav-list-item "><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:8888/adev2008/intro-to-dotnet-csharp-vs/csharp-fundamentals/" class="nav-list-link">C# Fundamentals</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:8888/adev2008/intro-to-dotnet-csharp-vs/namespaces/" class="nav-list-link">Namespaces</a> </li><li class="nav-list-item "> <a href="http://localhost:8888/adev2008/intro-to-dotnet-csharp-vs/data-types/" class="nav-list-link">Data Types</a> </li><li class="nav-list-item "> <a href="http://localhost:8888/adev2008/intro-to-dotnet-csharp-vs/console-io/" class="nav-list-link">Console I/O</a> </li><li class="nav-list-item "> <a href="http://localhost:8888/adev2008/intro-to-dotnet-csharp-vs/math/" class="nav-list-link">Math</a> </li><li class="nav-list-item "> <a href="http://localhost:8888/adev2008/intro-to-dotnet-csharp-vs/selections/" class="nav-list-link">Selections</a> </li><li class="nav-list-item "> <a href="http://localhost:8888/adev2008/intro-to-dotnet-csharp-vs/loops/" class="nav-list-link">Loops</a> </li><li class="nav-list-item "> <a href="http://localhost:8888/adev2008/intro-to-dotnet-csharp-vs/methods/" class="nav-list-link">Methods</a> </li><li class="nav-list-item "> <a href="http://localhost:8888/adev2008/intro-to-dotnet-csharp-vs/classes/" class="nav-list-link">Classes</a> </li><li class="nav-list-item "> <a href="http://localhost:8888/adev2008/intro-to-dotnet-csharp-vs/testing-classes/" class="nav-list-link">Testing Classes</a> </li><li class="nav-list-item "> <a href="http://localhost:8888/adev2008/intro-to-dotnet-csharp-vs/enumerations/" class="nav-list-link">Enumerations</a> </li></ul></li><li class="nav-list-item "><a href="http://localhost:8888/adev2008/intro-to-dotnet-csharp-vs/msdn/" class="nav-list-link">Microsoft Developer Network</a></li><li class="nav-list-item "><a href="http://localhost:8888/adev2008/intro-to-dotnet-csharp-vs/coding-conventions-standards/" class="nav-list-link">Coding Conventions and Standards</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:8888/adev2008/csharp-oop" class="nav-list-link">C# OOP</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:8888/adev2008/csharp-oop/class-libraries/" class="nav-list-link">Class Libraries</a></li><li class="nav-list-item "><a href="http://localhost:8888/adev2008/csharp-oop/properties/" class="nav-list-link">Properties</a></li><li class="nav-list-item "><a href="http://localhost:8888/adev2008/csharp-oop/inheritance/" class="nav-list-link">Inheritance</a></li><li class="nav-list-item "><a href="http://localhost:8888/adev2008/csharp-oop/static-classes/" class="nav-list-link">Static Classes</a></li><li class="nav-list-item "><a href="http://localhost:8888/adev2008/csharp-oop/exceptions/" class="nav-list-link">Exceptions</a></li><li class="nav-list-item "><a href="http://localhost:8888/adev2008/csharp-oop/assembly-references/" class="nav-list-link">Assembly References</a></li><li class="nav-list-item "><a href="http://localhost:8888/adev2008/csharp-oop/object-browser/" class="nav-list-link">Object Browser</a></li></ul></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:8888/adev2008/unit-testing/unit-testing/" class="nav-list-link">Unit Testing</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:8888/adev2008/unit-testing/mstest/" class="nav-list-link">MSTest</a></li><li class="nav-list-item "><a href="http://localhost:8888/adev2008/unit-testing/test-planning/" class="nav-list-link">Test Planning</a></li><li class="nav-list-item "><a href="http://localhost:8888/adev2008/unit-testing/running-unit-tests/" class="nav-list-link">Running Unit Tests</a></li><li class="nav-list-item active"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:8888/adev2008/unit-testing/writing-unit-tests/" class="nav-list-link active">Writing Unit Tests</a><ul class="nav-list"><li class="nav-list-item "> <a href="http://localhost:8888/adev2008/unit-testing/constructor-tests/" class="nav-list-link">Constructor Tests</a> </li><li class="nav-list-item "> <a href="http://localhost:8888/adev2008/unit-testing/property-tests/" class="nav-list-link">Property Tests</a> </li><li class="nav-list-item "> <a href="http://localhost:8888/adev2008/unit-testing/method-tests/" class="nav-list-link">Method Tests</a> </li><li class="nav-list-item "> <a href="http://localhost:8888/adev2008/unit-testing/accessing-base-class-fields/" class="nav-list-link">Accessing Base Class Fields</a> </li></ul></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:8888/adev2008/events/events/" class="nav-list-link">Events</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:8888/adev2008/events/delegates/" class="nav-list-link">Delegates</a></li><li class="nav-list-item "><a href="http://localhost:8888/adev2008/events/event-members/" class="nav-list-link">Event Class Members</a></li><li class="nav-list-item "><a href="http://localhost:8888/adev2008/events/event-handling/" class="nav-list-link">Event Handling</a></li></ul></li><li class="nav-list-item"><a href="http://localhost:8888/adev2008/data-structures/data-structures/" class="nav-list-link">Data Structures</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:8888/adev2008/windows-forms-apps/windows-forms-apps/" class="nav-list-link">Windows Forms Apps</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:8888/adev2008/windows-forms-apps/winform-basics/" class="nav-list-link">Winform Basics</a></li><li class="nav-list-item "><a href="http://localhost:8888/adev2008/windows-forms-apps/winform-control-classes/" class="nav-list-link">Winform Control Classes</a></li><li class="nav-list-item "><a href="http://localhost:8888/adev2008/windows-forms-apps/messagebox-class/" class="nav-list-link">Messagebox Class</a></li><li class="nav-list-item "><a href="http://localhost:8888/adev2008/windows-forms-apps/about-box-form/" class="nav-list-link">About Box Form</a></li><li class="nav-list-item "><a href="http://localhost:8888/adev2008/windows-forms-apps/debugging/" class="nav-list-link">Debugging</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:8888/adev2008/data-binding/data-binding/" class="nav-list-link">Data Binding</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:8888/adev2008/data-binding/data-binding-basics/" class="nav-list-link">Data Binding Basics</a></li><li class="nav-list-item "><a href="http://localhost:8888/adev2008/data-binding/simple-data-binding/" class="nav-list-link">Simple Data Binding</a></li><li class="nav-list-item "><a href="http://localhost:8888/adev2008/data-binding/complex-data-binding/" class="nav-list-link">Complex Data Binding</a></li><li class="nav-list-item "><a href="http://localhost:8888/adev2008/data-binding/combobox-data-binding/" class="nav-list-link">ComboBox Data Binding</a></li><li class="nav-list-item "><a href="http://localhost:8888/adev2008/data-binding/advanced-techniques/" class="nav-list-link">Advanced Techniques</a></li></ul></li><li class="nav-list-item"><a href="http://localhost:8888/adev2008/text-file-io/text-file-io/" class="nav-list-link">Text File IO</a></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:8888/adev2008/adonet/adonet/" class="nav-list-link">ADO.NET</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:8888/adev2008/adonet/ado-net-basics/" class="nav-list-link">ADO.NET Basics</a></li></ul></li><li class="nav-list-item"><a href="#" class="nav-list-expander"><svg viewBox="0 0 24 24"><use xlink:href="#svg-arrow-right"></use></svg></a><a href="http://localhost:8888/adev2008/appendixes/appendixes/" class="nav-list-link">Appendixes</a><ul class="nav-list "><li class="nav-list-item "><a href="http://localhost:8888/adev2008/appendixes/documentation-samples/" class="nav-list-link">Documentation Samples</a></li></ul></li></ul> </nav> <footer class="site-footer"> This site uses <a href="https://github.com/pmarsceill/just-the-docs">Just the Docs</a>, a documentation theme for Jekyll. </footer> </div> <div class="main" id="top"> <div id="main-header" class="main-header"> <div class="search"> <div class="search-input-wrap"> <input type="text" id="search-input" class="search-input" tabindex="0" placeholder="Search ADEV Programming" aria-label="Search ADEV Programming" autocomplete="off"> <label for="search-input" class="search-label"><svg viewBox="0 0 24 24" class="search-icon"><use xlink:href="#svg-search"></use></svg></label> </div> <div id="search-results" class="search-results"></div> </div> </div> <div id="main-content-wrap" class="main-content-wrap"> <nav aria-label="Breadcrumb" class="breadcrumb-nav"> <ol class="breadcrumb-nav-list"> <li class="breadcrumb-nav-list-item"><a href="http://localhost:8888/adev2008/unit-testing/unit-testing/">Unit Testing</a></li> <li class="breadcrumb-nav-list-item"><span>Writing Unit Tests</span></li> </ol> </nav> <div id="main-content" class="main-content" role="main"> <h1 class="no_toc" id="writing-unit-tests"> <a href="#writing-unit-tests" class="anchor-heading" aria-labelledby="writing-unit-tests"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Writing Unit Tests </h1> <h2 class="no_toc text-delta" id="table-of-contents"> <a href="#table-of-contents" class="anchor-heading" aria-labelledby="table-of-contents"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Table of Contents </h2> <ol id="markdown-toc"> <li><a href="#unit-test-classes" id="markdown-toc-unit-test-classes">Unit Test Classes</a> <ol> <li><a href="#naming-convention" id="markdown-toc-naming-convention">Naming Convention</a></li> </ol> </li> <li><a href="#unit-test-methods" id="markdown-toc-unit-test-methods">Unit Test Methods</a> <ol> <li><a href="#naming-convention-1" id="markdown-toc-naming-convention-1">Naming Convention</a></li> </ol> </li> <li><a href="#aaa-pattern" id="markdown-toc-aaa-pattern">AAA Pattern</a></li> <li><a href="#assert-class" id="markdown-toc-assert-class">Assert Class</a></li> <li><a href="#reflection" id="markdown-toc-reflection">Reflection</a> <ol> <li><a href="#privateobject-class" id="markdown-toc-privateobject-class">PrivateObject Class</a></li> <li><a href="#privatetype-class" id="markdown-toc-privatetype-class">PrivateType Class</a></li> </ol> </li> <li><a href="#best-practices-for-writing-tests" id="markdown-toc-best-practices-for-writing-tests">Best Practices For Writing Tests</a></li> <li><a href="#test-method-examples" id="markdown-toc-test-method-examples">Test Method Examples</a></li> <li><a href="#further-reading" id="markdown-toc-further-reading">Further Reading</a></li> </ol> <p>After creating the test plan, you are now ready to start developing your unit tests.</p> <h2 id="unit-test-classes"> <a href="#unit-test-classes" class="anchor-heading" aria-labelledby="unit-test-classes"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Unit Test Classes </h2> <p>Declaring a unit test class is similar to declaring a regular class. The use of the <code class="language-plaintext highlighter-rouge">TestClass</code> attribute denotes the class as contain unit tests.</p> <div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">namespace</span> <span class="nn">ADEV.UnitTesting</span>
<span class="p">{</span>
    <span class="p">[</span><span class="n">TestClass</span><span class="p">]</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">PersonTests</span>
    <span class="p">{</span>

    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p class="alert alert-error">If your unit test class is missing the <code class="language-plaintext highlighter-rouge">TestClass</code> attribute, the Test Explorer will not recognize the class as containing unit tests.</p> <h3 id="naming-convention"> <a href="#naming-convention" class="anchor-heading" aria-labelledby="naming-convention"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Naming Convention </h3> <p>Unit test class identifiers are named by using the class name of the class you are testing followed by the word “Tests”. The test class above is testing a class named <code class="language-plaintext highlighter-rouge">Person</code>, because the test class identifier is <code class="language-plaintext highlighter-rouge">PersonTests</code>.</p> <h2 id="unit-test-methods"> <a href="#unit-test-methods" class="anchor-heading" aria-labelledby="unit-test-methods"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Unit Test Methods </h2> <p>You will code unit test methods within the a class with the <code class="language-plaintext highlighter-rouge">TestClass</code> attribute. As a general guideline, you will write one unit test method per test case in your test plan.</p> <p>Unit test methods are declared and defined like other methods. The use of the <code class="language-plaintext highlighter-rouge">TestMethod</code> attribute denotes the method is a unit test method.</p> <div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">namespace</span> <span class="nn">ADEV.UnitTesting</span>
<span class="p">{</span>
    <span class="p">[</span><span class="n">TestClass</span><span class="p">]</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">PersonTests</span>
    <span class="p">{</span>
        <span class="p">[</span><span class="n">TestMethod</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">TestMethod1</span><span class="p">()</span>
        <span class="p">{</span>

        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p class="alert alert-error">If your unit test method is missing the <code class="language-plaintext highlighter-rouge">TestMethod</code> attribute, the Test Explorer will not recognize the method as a unit tests method.</p> <h3 id="naming-convention-1"> <a href="#naming-convention-1" class="anchor-heading" aria-labelledby="naming-convention-1"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Naming Convention </h3> <p>Unit test method identifiers will follow this general naming format: <code class="language-plaintext highlighter-rouge">UnitDescription_Data_Result</code></p> <p>Example:</p> <div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">namespace</span> <span class="nn">ADEV.UnitTesting</span>
<span class="p">{</span>
    <span class="p">[</span><span class="n">TestClass</span><span class="p">]</span>
    <span class="k">public</span> <span class="k">class</span> <span class="nc">PersonTests</span>
    <span class="p">{</span>
        <span class="p">[</span><span class="n">TestMethod</span><span class="p">]</span>
        <span class="k">public</span> <span class="k">void</span> <span class="nf">Constructor_NameNull_Exception</span><span class="p">()</span>
        <span class="p">{</span>

        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <h2 id="aaa-pattern"> <a href="#aaa-pattern" class="anchor-heading" aria-labelledby="aaa-pattern"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> AAA Pattern </h2> <p>The AAA (Arrange, Act, Assert) is a common pattern for writing unit test methods.</p> <ul> <li>The <strong>Arrange</strong> part of the unit test defines test data and initializes an object used for the test.</li> <li>The <strong>Act</strong> part of the test invokes the unit being tested under the conditions of the test case.</li> <li>The <strong>Assert</strong> part of the test verifies that the unit being tested behaved as expected.</li> </ul> <h2 id="assert-class"> <a href="#assert-class" class="anchor-heading" aria-labelledby="assert-class"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Assert Class </h2> <p>The <code class="language-plaintext highlighter-rouge">Assert</code> class contains a collection of methods to determine the result of a test. If the condition being tested is not met, an <code class="language-plaintext highlighter-rouge">AssertFailedException</code> is thrown.</p> <p>Common Method</p> <ul> <li><strong>AreEqual(Object, Object)</strong> - Tests whether the specified objects are equal and throws an exception if the two objects are not equal.</li> <li><strong>AreNotEqual(Object, Object)</strong> - Tests whether the specified values are unequal and throws an exception if the two values are equal.</li> <li><strong>IsTrue(Boolean)</strong> - Tests whether the specified condition is <code class="language-plaintext highlighter-rouge">true</code> and throws an exception if the condition is <code class="language-plaintext highlighter-rouge">false</code>.</li> <li><strong>IsFalse(Boolean)</strong> - Tests whether the specified condition is <code class="language-plaintext highlighter-rouge">false</code> and throws an exception if the condition is <code class="language-plaintext highlighter-rouge">true</code>.</li> <li><strong>ThrowsException&lt;T&gt;()</strong> - Tests whether the code specified by delegate action throws exact given exception of type <code class="language-plaintext highlighter-rouge">T</code> (and not of derived type) and throws <code class="language-plaintext highlighter-rouge">AssertFailedException</code> if code does not throws exception or throws exception of type other than <code class="language-plaintext highlighter-rouge">T</code>. This method returns a reference to the exception the exception if one is thrown.</li> </ul> <p class="alert alert-note">All <code class="language-plaintext highlighter-rouge">Assert</code> methods will throw an <code class="language-plaintext highlighter-rouge">AssertFailedException</code> when the condition is not met. The result of the test is a fail.</p> <h2 id="reflection"> <a href="#reflection" class="anchor-heading" aria-labelledby="reflection"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Reflection </h2> <p>Many of the tests you will develop will involve verifying the state of an object. State is stored in <code class="language-plaintext highlighter-rouge">private</code> fields in the class. To verify test cases where the result deals with object state, you will need to use a concept called <strong>Reflection</strong>. Reflection is the ability to retrieve data that is normally not accessible at run-time.</p> <p>In the testing you did prior to this topic, you would have normally called an accessor method to verify changes to state. This is no longer satisfactory, as one of your unit testing goals is to isolate the unit your are testing. This means you do not want to invoke other units of the class while testing a specific unit.</p> <h3 id="privateobject-class"> <a href="#privateobject-class" class="anchor-heading" aria-labelledby="privateobject-class"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> PrivateObject Class </h3> <p>The <code class="language-plaintext highlighter-rouge">PrivateObject</code> class represents a <code class="language-plaintext highlighter-rouge">public</code> “version” of an object. The class contains methods to accesses <code class="language-plaintext highlighter-rouge">private</code> fields, methods, and properties.</p> <p>To gain access to an object’s <code class="language-plaintext highlighter-rouge">private</code> members, construct an instance of <code class="language-plaintext highlighter-rouge">PrivateObject</code>, initializing it with a reference to the object you wish access its <code class="language-plaintext highlighter-rouge">private</code> members.</p> <div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">Person</span> <span class="n">person</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">Person</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">amountOfMoney</span><span class="p">);</span>

<span class="n">PrivateObject</span> <span class="n">target</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">PrivateObject</span><span class="p">(</span><span class="n">person</span><span class="p">);</span>
</code></pre></div></div> <p>Use the following methods of the <code class="language-plaintext highlighter-rouge">PrivateObject</code> class:</p> <ul> <li><code class="language-plaintext highlighter-rouge">GetField(String) : Object</code> - Returns the value of the specified field.</li> <li><code class="language-plaintext highlighter-rouge">SetField(String, Object) : void</code> - Sets the specified field to the specified value.</li> <li><code class="language-plaintext highlighter-rouge">Invoke(String, Object[]) : Object</code> - Invokes the specified method. The <code class="language-plaintext highlighter-rouge">Object[]</code> represents the arguments. Returns the result of the method.</li> </ul> <div class="language-csharp highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">PrivateObject</span> <span class="n">target</span> <span class="p">=</span> <span class="k">new</span> <span class="nf">PrivateObject</span><span class="p">(</span><span class="n">person</span><span class="p">);</span>

<span class="kt">decimal</span> <span class="n">actual</span> <span class="p">=</span> <span class="p">(</span><span class="kt">decimal</span><span class="p">)</span><span class="n">target</span><span class="p">.</span><span class="nf">GetField</span><span class="p">(</span><span class="s">"amountOfMoney"</span><span class="p">);</span>
</code></pre></div></div> <h3 id="privatetype-class"> <a href="#privatetype-class" class="anchor-heading" aria-labelledby="privatetype-class"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> PrivateType Class </h3> <p>The <code class="language-plaintext highlighter-rouge">PrivateType</code> class is used like <code class="language-plaintext highlighter-rouge">PrivateObject</code>, but is used for Static Classes.</p> <p class="alert alert-future-lesson">The <code class="language-plaintext highlighter-rouge">PrivateType</code> class is also used when gaining access to <code class="language-plaintext highlighter-rouge">base</code> class members.</p> <h2 id="best-practices-for-writing-tests"> <a href="#best-practices-for-writing-tests" class="anchor-heading" aria-labelledby="best-practices-for-writing-tests"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Best Practices For Writing Tests </h2> <p>Before you really dive into developing your unit tests, keep the following best practices in mind:</p> <ol> <li>A unit test should only test a single outcome. Do not combine multiple outcomes into a single test method.</li> <li>A unit is tested in isolation of other units in the class (with the exception of the constructor).</li> <li>Always test constructor methods first.</li> <li>Complete all the tests for a unit before moving onto another unit.</li> <li>Group tests in your test class by unit, not by test type.</li> <li>Keep the code in your unit test method simple.</li> <li>Try to order your tests in order of dependency (when known or possible).</li> <li>No unit is too insignificant to test.</li> </ol> <h2 id="test-method-examples"> <a href="#test-method-examples" class="anchor-heading" aria-labelledby="test-method-examples"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Test Method Examples </h2> <p>The following unit test method examples will follow the <a href="/adev2008/unit-testing/sample-test-plan">sample test plan</a>. Not every test case will be demonstrated here, as some of the test cases will produce similar unit test method implementation.</p> <ul> <li><a href="/adev2008/unit-testing/constructor-tests">Constructor Tests</a></li> <li><a href="/adev2008/unit-testing/property-tests">Property Tests</a></li> <li><a href="/adev2008/unit-testing/method-tests">Method Tests</a></li> <li><a href="/adev2008/unit-testing/accessing-base-class-fields">Accessing Base Class Fields</a></li> </ul> <h2 id="further-reading"> <a href="#further-reading" class="anchor-heading" aria-labelledby="further-reading"><svg viewBox="0 0 16 16" aria-hidden="true"><use xlink:href="#svg-link"></use></svg></a> Further Reading </h2> <ul> <li><a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.testtools.unittesting.assert?view=visualstudiosdk-2022" target="_blank">Assert Class</a></li> <li><a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.testtools.unittesting.privateobject?view=visualstudiosdk-2022" target="_blank">PrivateObject Class</a></li> <li><a href="https://docs.microsoft.com/en-us/dotnet/api/microsoft.visualstudio.testtools.unittesting.privatetype?view=visualstudiosdk-2022" target="_blank">PrivateType Class</a></li> </ul> <hr> <footer> <p><a href="#top" id="back-to-top">Back to top</a></p> <p class="text-small text-grey-dk-100 mb-0">Copyright &copy; 2022 Thirsty Cod3r.</p> <div class="d-flex mt-2"> <p class="text-small text-grey-dk-000 mb-0"> <a href="https://github.com/adevrrc/adevrrc.github.io/tree/main/adev2008/unit-testing/writing-unit-tests.md" id="edit-this-page">Edit this page on GitHub</a> </p> </div> </footer> </div> </div> <div class="search-overlay"></div> </div> </body> </html>
